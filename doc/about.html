<h2><strong>GUI Overview</strong></h2>
<ul>
<li><b>Config Basics</b> tab: input parameters common to all models (e.g., domain grid, simulation time, choice/frequency of outputs)</li>
<li><b>Microenvironment</b> tab:&nbsp;&nbsp; microenvironment parameters that are model-specific</li>
<li><b>User Params</b> tab:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; user parameters that are model-specific</li>
<li><b>Out: Plots</b> tab:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; output display of cells and substrates</li>
</ul>
Clicking the 'Run' button will use the specified parameters and start a simulation. When clicked, it creates an "Output" widget
that can be clicked/expanded to reveal the progress (text) of the simulation. When the simulation generates output files,
they can be visualized in the "Out: Plots" tab. The "# cell frames" will be dynamically updated 
as those output files are generated by the running simulation. When the "Run" button is clicked, it toggles to a "Cancel" button
that will terminate (not pause) the simulation.

<h2><strong>Introduction</strong></h2>

<p>Synthetic biology and other bioengineering techniques are increasingly creating novel compounds that can target and tune specific aspects of cell phenotype (behavior), such as proliferation, adhesion, motility, and metabolism. This presents both key opportunities and challenges: <strong><em>W</em></strong><strong><em>hat if&nbsp;</em></strong>we could tune what a therapeutic does, and where it is delivered?&nbsp;<strong><em>Which&nbsp;</em></strong>therapies would be worth delivering? <b><i>What&nbsp;</i></b>are the key design parameters?&nbsp;</p>

<p>The aim of this tool is to explore these what if questions: users can set nanoparticle, tissue, cell, and drug response parameters for a growing tumor, and see for themselves how things could play out for their design choices.</p>


<h3>Modeling description</h3>

<p>
In this model, We simulate a tumor growing in the microenvironment. We first follow <a href="https://pubs.acs.org/doi/abs/10.1021/nl052396o">experimental data</a> to fit the dynamics of celluar update or internalization. We also propose a dynamics equation for drug release to transit NPs while release drug in of individual cells, and then explore the tumor response to drug. Our model introduces a novel tracking of nanoparticle <b><i>populations</i></b> in each individual cells, allowing better modeling of drug release by internalized nanoparticles and long-term therapeutic implications. </p>



<h3>Modeling approach</h3>

<p>We used agent-based models to simulate the tumor cells growing in the microenvironment. The modeling mainly involves two processes: <i>pharmacokinetics</i> and <i>pharmacodynamics</i>. </p>


<h4>Nanoparticles and pharmacokinetics:</h4>

<p>In the microenvironment, NPs are released in dose (by setting the initial condition and Dirichlet boundary condition). Tumor cells uptake the NPs with the following dynamics equation. In the uptake equation, the celluar uptake rate <em>U<sub>i</sub></em> is proportional to internalization rate <em>r<sub>I</sub></em>, and inverse with the number of internalized nanoparticles <em>n<sub>I</sub></em>, with a capacity of <em>n<sup>*</sup></em>. Here, we also introduce a drug release model, in which NPs go through several transition processes, with releasing drug in the process, where the transition dynamics for NPs in <i>jth</i>: <em>n<sub>j</sub></em> is related with transit from last process <em>r<sub>j-1</sub></em><em>n<sub>j-1</sub></em> and next process <em>r<sub>j</sub></em><em>n<sub>j</sub></em>, and transit numbers <em>N</em> and the intial drug on one nanoparticle <em>C<sup>*</sup></em>; for the release rate <em>r<sub>j</sub></em> is proportional to the remained drug in the NPs within <i>jth</i> transition process <em>C<sub>j</sub></em> and inverse with the drug concentration <em>c</em> inside of each cells, see the following schematic: </p>

<p style="text-align: center;"> <img src="doc/pk1.png" style="width: auto; height: auto;max-width: auto;max-height: 38px"> &nbsp;&nbsp;
                                <img src="doc/pk2.png" style="width: auto; height: auto;max-width: auto;max-height: 45px"> &nbsp;&nbsp;
								<img src="doc/pk3.png" style="width: auto; height: auto;max-width: auto;max-height: 35px"> 
								</p>

<p style="text-align: center;"> <img src="doc/release_drug.png" style="width: auto; height: auto;max-width: auto;max-height: 200px"> </p>



<h4>Cells and drug pharmacodynamics:</h4>

<p><strong>Without drug:</strong></p>

<p>Cells will be assigned a wild-type microenvironment-dependent&nbsp;phenotype&nbsp;<strong>P</strong><sub>0</sub>(<strong>E</strong>), where <b>P&nbsp;</b>is the vector of phenotype properties, and&nbsp;<strong>E&nbsp;</strong>is the cell&#39;s local microenvironmental conditions. As in <a href="https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991">PhysiCell</a> [1], cell cycle entry increases with oxygenation, apoptosis occurs at a steady background rate throughout viable tissue, and necrosis increases with oxygen depletion.&nbsp;</p>


<p><strong>With drug:</strong></p>

<p>We model the maximum phenotype response vector&nbsp;<strong>P</strong><sub>M</sub> as tumor response to drug. We assume drug has a Hill coefficient (<em>h</em>)<em>&nbsp;</em>and half-max effect drug concentration (c<sub>0.5</sub>). We use a Hill effects model:</p>

<p style="text-align: center;"><em>E</em> = c<em><sup>h</sup></em> / ( c<sub>0.5</sub><em><sup>h</sup></em> + c<em><sup>h</sup></em>).</p>

<p>Note that the code will also allow us to replace drug with an AUC (area-under-the-curve) model &#8747;c(s) ds (from 0 to t). Also, the code will allow an active damage and repair model, based upon the drug concentration. </p>

<p>For each cell&#39;s current effect <em>E</em>, we set its phenotype to:</p>

<p style="text-align: center;"><strong>P</strong>&nbsp;= (1-<em>E</em>)&nbsp;<strong>P</strong><sub>0</sub>(<em>E</em>) + <em>E</em>&nbsp;<strong>P</strong><sub>M</sub></p>



<h3>About the software</h3>

<p>This model is funded by IU Engineered nanoBIO Node, as a Demo for nanoparticles on cancer treatment project. The models are built using <a href="https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991">PhysiCell</a>: a C++ framework for multicellular systems biology [1].</p>


<h2><strong>Chemical components:</strong></h2>

<p>All chemical signals move by chemical diffusion in the simulated environment, using <a href="http://dx.doi.org/10.1093/bioinformatics/btv730">BioFVM</a> [2] to solve the reaction-diffusion equations. A key property is the <em>diffusion length scale</em>. Diffusion (with a diffusion coefficient <em>D</em>) helps spread a signal over large distances, while decay (and uptake) (with coefficient <em>&lambda;</em>) eliminates the signal to slow its spread. These effects compete to determine the characteristic distance <i>L</i>that a chemical signal travels.</p>

<p>In our model, oxygen and NPs are diffused with <a href="http://dx.doi.org/10.1093/bioinformatics/btv730">BioFVM</a> [2] by setting the initial condition and Dirichlet boundary condition. </p>



<h2><b>Cell agents:</b></h2>

<h3>Key features in the agent-based models:</h3>


<h4>Birth and death:</h4>

<p>Cells can proliferate (divide into two daughter cells of half size), with division rates regulated by cell rules. In our model, cells continuously work to grow towards a &quot;target&quot; mature volume.</p>

<p>Note that birth and death are stochastic events for each cell agent: if such a process occurs at rate <em>r</em>, then between now (<em>t</em>) and soon (<em>t</em> + &Delta;<em>t</em>), the probability of the event occurring for that agent is <em>r</em>&Delta;<em>t</em>.</p>

<p>In our model, tumor cells would experience normal apoptosis at a steady background rate throughout viable tissue, and necrosis increasing with oxygen depletion in no drug microenvironment. With drug, the phenotype of tumor cells changes with interpolation with background rate and max effect as described in section of <b>Modeling approach</b>. </p>


<h4>Secretion and uptake:</h4>

<p>
Cells can secrete chemical factors, or they can remove them (i.e., consume or uptake). This can contribute to gradients in chemical factors, and it&#39;s a key method of communication between cells. Moreover, cells can &quot;sample&quot; the chemical state of their surrounding environment. Secreting is sending a signal. Uptaking and sampling is receiving a signal.</p>

<p>In our model, tumor cells uptake the NPs, and then NPs release drug inside of each cells, see details in section of <b>Modeling approach</b>. </p>


<h4>Biased migration:</h4>

<p>Motile cells perform <em>biased migration</em>. After traveling for <em>T</em><sub>persistence</sub> time (the mean persistence time), they choose a new migration direction <span style="font-weight: bold;">d</span><sub>migrate</sub>. Based on the environmental conditions, the cell chooses a directional bias (intended direction) <span style="font-weight: bold;">d</span><sub>bias</sub> and a random unit vector <span style="font-weight: bold;">r</span>. The motile direction <span style="font-weight: bold;">d</span><sub>migrate</sub> is then determined by according to:</p>

<p style="text-align: center;"><span style="font-weight: bold;">d</span><sub>migrate</sub> = <em>b</em> <span style="font-weight: bold;">d</span><sub>bias</sub> + (1-<em>b</em>) <span style="font-weight: bold;">r</span>.</p>

<p>Here, <em>b</em> is a <em>bias</em> parameter (between 0 and 1) that determines how strongly biased migration is towards <span style="font-weight: bold;">d</span><sub>bias</sub>. If <em>b</em> =1, then migration is deterministic towards <span style="font-weight: bold;">d</span><sub>bias</sub>. If <em>b</em> = 0, then migration is completely random (Brownian).</p>

<p>Once the migration direction is chosen, it is normalized, and multiplied by the cell&#39;s migration speed.</p>

<p>In out model, we simplified cells as immotile.</p>


<h4>Mechanics:</h4>
<p>
Cell agents can stick to one another within a prescribed interaction distance (some multiple of their radius), and they can exert a pushing force on neighbors. PhysiCell [1] uses potential functions to implement these simple mechanics. Notably, PhysiCell is an off-lattice model, meaning that cells can have variable sizes, and can move freely without grid artifacts.
</p>

<p>They aren&#39;t required to move some prescribed number of spatial steps. They also can divide without checking for an open neighbor &quot;site&quot;. Instead, they can divide and push their neighbors out of the way. 
</p>


<h4>Cell-cell interactions:</h4>
<p>
In the model, we currently only have one type of cells (tumor cells). 
</p>



<h2><a id="instructions" name="instructions">Basic instructions</a></h2>

<p>Modify parameters in the &quot;Config Basics&quot;, &quot;Microenvironment&quot;, or &quot;User Params&quot; tabs. Click the &quot;Run&quot; button once you are ready.</p>

<p>To view the output results, click the &quot;Out: Plots&quot; tab, and move the slider bar to advance through simulation frames. 
Note that as the simulation runs, the &quot;# cell frames&quot; field will increase, so you can view more simulation frames.</p>

<p>If there are multiple substrates defined in the Microenvironment, you can select a different one from the drop-down widget in the Plots tab. You can also fix the colormap range of values.</p>

<p>Note that you can download full simulation data for further exploration in your tools of choice.</p>

